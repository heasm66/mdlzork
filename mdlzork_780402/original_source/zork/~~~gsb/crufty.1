<TITLE OGET>
	<DECLARE ("VALUE" ANY <OR ROOM OBJECT> ATOM)>
	<DPUSH	TP* (AB)>
	<DPUSH	TP* 2(AB)>
	<PUSHJ	P* IOGET>
	<JRST	FINIS>

<INTERNAL-ENTRY IOGET 2>
	<SUBM	M* (P)>
	<MOVE	A* -2(TP)>
	<GETYP	B* -3(TP)>
	<MOVEI	C* <- <* ,OPROPS 2> 1>>
	<CAIE	B* <TYPE-CODE OBJECT>>
	 <MOVEI	C* <- <* ,RPROPS 2> 1>>
	<MOVE	B* (TP)>
	<PUSHJ	P* OLKP>
	 <JRST	OGLOSE>
	<MOVE	B* 3(A)>
	<MOVE	A* 2(A)>
	<JRST	OGOUT>

OGLOSE	<MOVE	A* <TYPE-WORD FALSE>>
	<TDZA	B* B>
OGPOUT	<SUB	TP* [<(2) 2>]>
OGOUT	<SUB	TP* [<(4) 4>]>
	<JRST	MPOPJ>

; "A -- OBJECT/ROOM
   B -- ATOM
   C -- OFFSET FOR PROPERTY LIST"

OLKP	<SUBM	M* (P)>
	<ADD	A* C>
	<MOVE	A* (A)>
	<JUMPGE	A* OLKPLS>
OGETLP	<MOVE	C* 1(A)>
	<CAMN	B* C>
	 <JRST	OLKPWN>
	<ADD	A* [<(3) 3>]>
	<AOBJN	A* OGETLP>
OLKPLS	<JRST	MPOPJ>

OLKPWN	<SOS	(P)>
	<JRST	MPOPJ>

<SUB-ENTRY OPUT ("VALUE" <OR ROOM OBJECT> <OR ROOM OBJECT> ATOM ANY)>
	<DPUSH	TP* (AB)>
	<DPUSH	TP* 2(AB)>
	<DPUSH	TP* 4(AB)>
	<PUSHJ	P* IOPUT>
	<JRST	FINIS>

<INTERNAL-ENTRY IOPUT 3>
	<SUBM	M* (P)>
	<MOVE	A* -4(TP)>
	<GETYP	B* -5(TP)>
	<MOVEI	C* <- <* ,OPROPS 2> 1>>
	<CAIE	B* <TYPE-CODE OBJECT>>
	 <MOVEI	C* <- <* ,RPROPS 2> 1>>
	<MOVE	B* -2(TP)>
	<PUSHJ	P* OLKP>
	 <JRST	OPLOSE>
	<MOVE	B* -1(TP)>
	<MOVEM	B* 2(A)>
	<MOVE	B* (TP)>
	<MOVEM	B* 3(A)>
	<MOVE	A* -5(TP)>
	<MOVE	B* -4(TP)>
	<JRST	OGPOUT>
	
OPLOSE	<MOVE	A* <TYPE-WORD FALSE>>
	<MOVEI	B*>
	<JRST	OGPOUT>
 
<TITLE EXCRUCIATINGLY-UNTASTEFUL-CODE>
	<DECLARE ("VALUE" ATOM)>
	<PUSHJ	P* IEUC>
	<JRST	FINIS>

	<INTERNAL-ENTRY IEUC 0>
	<SUBM	M* (P)>
	<MOVE	A* <MQUOTE <RGLOC PRSVEC T>>>
	<ADD	A* GLOTOP 1>
	<HRRZ	A* 1 (A)>
	<ADDI	A* 1>
	<MOVEM	A* *60*>
	<ADDI	A* 2>
	<MOVEM	A* *61*>
	<ADDI	A* 2>
	<MOVEM	A* *62*>
	<MOVE	A* <TYPE-WORD ATOM>>
	<MOVE	B* <MQUOTE T>>
	<JRST	MPOPJ>